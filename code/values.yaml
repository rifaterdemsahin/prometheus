replicaCount: 1

image:
  repository: bitnami/grafana
  tag: latest
  pullPolicy: IfNotPresent

persistence:
  enabled: true
  accessModes:
    - ReadWriteOnce
  size: 1Gi  # Adjusted to a smaller size for CRC
  storageClass: ""
  annotations: {}

securityContext:
  enabled: true
  fsGroup: 1001  # Ensures the container can write to mounted volumes
  runAsUser: 1001  # Ensures the container runs as user 1001

initContainers:
  - name: fix-permissions
    image: busybox
    command: ['sh', '-c', 'mkdir -p /opt/bitnami/grafana/data/plugins && chown -R 1001:1001 /opt/bitnami/grafana/data/plugins && chmod -R 775 /opt/bitnami/grafana/data/plugins']
    volumeMounts:
      - name: grafana-storage
        mountPath: /opt/bitnami/grafana/data

resources:
  limits:
    cpu: 500m  # Reduced CPU limit for CRC
    memory: 512Mi  # Reduced memory limit for CRC
  requests:
    cpu: 50m  # Reduced CPU request for CRC
    memory: 128Mi  # Reduced memory request for CRC

service:
  type: ClusterIP
  port: 80
  annotations: {}

ingress:
  enabled: false

livenessProbe:
  enabled: true
  initialDelaySeconds: 120
  timeoutSeconds: 30
  failureThreshold: 6

readinessProbe:
  enabled: true
  initialDelaySeconds: 30
  timeoutSeconds: 10
  failureThreshold: 6

grafana:
  admin:
    existingSecret: ""
  dashboardsConfigMaps: {}
  dashboards:
    enabled: true
  plugins: ""
  sidecar:
    dashboards:
      enabled: true
    datasources:
      enabled: true

volumeMounts:
  - name: grafana-storage
    mountPath: /opt/bitnami/grafana/data

volumes:
  - name: grafana-storage
    persistentVolumeClaim:
      claimName: grafana-pvc
